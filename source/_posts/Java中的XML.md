---
title: Java锟??锟斤拷XML
date: 2018-07-20 11:00:21
tags:
---
#### HTML?XML???
- HTML???????XML?????
- HTML????`</p>`??????XML????
- XML????????????????????`/`??
- XML????????????
- HTML??????????XML???????????

#### ??XML??
????xml???books.xml
```XML
<?xml version="1.0" encoding="UTF-8"?>
<bookstore>
	<book id="1">
		<name>?????</name>
		<author>????</author>
		<year>2014</year>
		<price>89</price>
	</book>
	<book id="2">
		<name>?????</name>
		<year>2004</year>
		<price>77</price>
		<language>English</language>
	</book>
</bookstore>
```
- DOM??????
    1???DocumentBuilder???
    ```java
    DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
    DocumentBuilder db = dbf.newDocumentBuilder();
    ```
    2???parser????books.xml????????;
    ```java
    Document document = db.parse("books.xml");
    ```
    3?????
    ```java
    //????book?????
	NodeList bookList = document.getElementsByTagName("book");
    //?????book??
    for (int i = 0; i < bookList.getLength(); i++) {
        //?? item(i)?? ????book???nodelist?????0??
        Node book = bookList.item(i);

        //??book?????????
        NamedNodeMap attrs = book.getAttributes();

        //???????book???????1?id??
        //?book??????????????Element??
        Element book = (Element) bookList.item(i);

        //??getAttribute("id")???????
        String attrValue = book.getAttribute("id");
        
        //??book??????
        NodeList childNodes = book.getChildNodes();
    }
    ```
    > ?xml??????????DOM????????API

- SAX???????
    1???SAXParserFactory???newsInstance()????SAXParserFactory??
    ```java
    SAXParserFactory factory = SAXParserFactory.newInstance();
    ```
    2???SAXParserFactory???newSAXParser()????SAXParser??
    ```java
    SAXParser parser = factory.newSAXParser();
    ```
    3????????DefaultHandler????????????????????????
    ```java
    SAXParserHandler handler = new SAXParserHandler();
	parser.parse("books.xml", handler);
    ```
    >??????
    ```java
    //????????
	@Override
	public void startDocument() throws SAXException {
		// TODO Auto-generated method stub
		super.startDocument();
		System.out.println("SAX????");
	}

    //????????
    @Override
	public void endDocument() throws SAXException {
		// TODO Auto-generated method stub
		super.endDocument();
		System.out.println("SAX????");
	}

    //??XML??
    @Override
	public void startElement(String uri, String localName, String qName,
			Attributes attributes) throws SAXException {
		//??DefaultHandler??startElement??
		super.startElement(uri, localName, qName, attributes);
		if (qName.equals("book")) {
			//??book????????????????????
			String value = attributes.getValue("id");
			System.out.println("book??????" + value);

		}else if (!qName.equals("name") && !qName.equals("bookstore")) {
			System.out.print("?????" + qName + "---");
		}
	}
	
	@Override
	public void endElement(String uri, String localName, String qName)
			throws SAXException {
		//??DefaultHandler??endElement??
		super.endElement(uri, localName, qName);
		//???????????????
		if (qName.equals("book")) {
			System.out.println("???????????");
		}
	}
	
	@Override
	public void characters(char[] ch, int start, int length)
			throws SAXException {
		// TODO Auto-generated method stub
		super.characters(ch, start, length);
		value = new String(ch, start, length);
		if (!value.trim().equals("")) {
			System.out.println("?????" + value);
		}
	}
    ```
- JDOM??
    1???SAXBuilder???
    ```
    SAXBuilder saxBuilder = new SAXBuilder();
    ```
    2??????????xml?????????
    ```
    in = new FileInputStream("books.xml");
    ```
    3???saxBuilder?build??????????
    saxBuilder?
    ```
    Document document = saxBuilder.build(in);
    ```
    4???document????xml??????
    ```
    Element rootElement = document.getRootElement();
    ```
    5????????????List???????
    ```
    List<Element> bookList = rootElement.getChildren();
    for (Element book : bookList) {
        // ??book?????
        List<Attribute> attrList = book.getAttributes();
        // ????????????????
        book.getAttributeValue("id");
    
        // ?book??????????????????
        List<Element> bookChilds = book.getChildren();
        for (Element child : bookChilds) {
            System.out.println("????" + child.getName() + "----????"
                    + child.getValue());
        }
    }
}
    ```
    > ????????????????????
    ```java
    InputStreamReader isr = new InputStreamReader(in, "UTF-8");
	Document document = saxBuilder.build(isr);
    ```
- DOM4J??
    1???reader???read????books.xml??,??docuemnt??
    ```java
    SAXReader reader = new SAXReader();
    Document document = reader.read(new File("src/res/books.xml"));
    ```
    2???document???????
    ```java
    Element bookStore = document.getRootElement();
    ```
    3???element???elementIterator???????
    ```java
    Iterator it = bookStore.elementIterator();
    ```
    4????????????????
    ```java
    while (it.hasNext()) {
        Element book = (Element) it.next();
        // ??book?????????
        List<Attribute> bookAttrs = book.attributes();
        for (Attribute attr : bookAttrs) {
            System.out.println("????" + attr.getName() + "--????"
                    + attr.getValue());
        }
        //?????
        Iterator itt = book.elementIterator();
        while (itt.hasNext()) {
            Element bookChild = (Element) itt.next();
            System.out.println("????" + bookChild.getName() + "--????" + bookChild.getStringValue());
        }
    }
    ```
- ?????????
    - DOM???????????????DOM?
        >????????????????????????????????????
        ????xml??????????????????????????????
    - SAX??????????????
        >?????????????????xml???
        ?????????
    - JDOM?API??????Collections?
    - DOM4J?JDOM???????????????XML????????????????????????????????????????
----    
#### ??XML??
- DOM
    1???DocumentBuilder??
    ```java
    DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
    DocumentBuilder db = dbf.newDocumentBuilder();
    ```
    2??????????
    ```java
    document.setXmlStandalone(true);
    Element bookstore = document.createElement("bookStore");
    //?bookstore?????????book
    Element book = document.createElement("book");
    Element name = document.createElement("name");
    name.setTextContent("???");
    
    book.appendChild(name);
    book.setAttribute("id", "1");
    //?book?????bookstore????
    bookstore.appendChild(book);
    //?bookstore????????book????dom??
    document.appendChild(bookstore);
    ```
    3???XML??
    ```java
    TransformerFactory tff = TransformerFactory.newInstance();
    Transformer tf = tff.newTransformer();
    //?????????
    tf.setOutputProperty(OutputKeys.INDENT, "yes");
    tf.transform(new DOMSource(document),new StreamResult(new File("books1.xml")));
    ```
- SAX
- JDOM
- DOM4J
----
#### ??XML??
- ??????
    >?????????DTD)?????????????????????????
    - ????????XML???
        ``` XML
        <?xml version="1.0"?>
        <!DOCTYPE configuration[

            <!ELEMENT configuration...>
            ...
        ]>
        <configuration>
        ...
        </configuration>
        ```
        >???????DOCTYPE??????[...]???????????????????????configuration
    - ?????DTD???????SYSTEM??
        ```XML
        <!DOCTYPE configuration SYSTEM "config.dtd">
        <!DOCTYPE configuration SYSTEM "http://myserver.com/config.dtd">
        ```
    - ??PUBLIC?????DOM???????????????
        ```java
        class MyEntityResolver implements EntityResolver{
            public InputSource resolveEntity(String publicId, String systemID){
                if(publicID.equals(a knowx ID)){
                    return new InputSource(DTD data):
                }else{
                    return null;
                }
            }
        }
        ```
        >PS???DTD??????????????????????????????????????????????????????????????
- XML Schema
    - ??Schema?????????????????
    ```XML
    <?xml version="1.0"?>
    <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    </project>
    ```
    - ??xsd:??XSL Schema?????????????????????
    <xsd:element name="name" type="xsd:string"/>
    - ?ref??????Schema????????????????
    <xsd:element ref="name"/>
    <xsd:element name="style" type=StyleType"/>
        <xsd:restriction base="xsd:string"/>
            <xsd:enumeration value="PLAIN"/>
        </xsd:restriction>
    </xsd:element>
#### ??XPath????
- ?????username??,??XPath????/configuration/database/username
    ```
    <configfuration>
        <database>
            <username id="test">pinnuli</username>
            <password>123456</password>
        </database>
    </configfuration>
    ```
- ?XPathFactory????XPath???????evaluate????XPath???
    ```
    XPathFactory xpFactory = XPathFactory.newInstance();
    path = xpfactory.newXPath();
    String username = path.evaluate(/configuration/database/username",doc);
    ```
>???????????????????????
----
#### XML??????
- ??xmlns??
    ```XML
    <element xmlns="namespaceURI1">
        <child xmlns="namespaceURI2">
            grandchildren
        </child>
    </element>
    ```
    >??????????????????????????
- ??xmlns:prefix="namespaceURI"?????????????
    ``` 
    <xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
        <xsd:element name="pinnuli" type="haha"/>
        ...
    </xsd:schema>
    ```
    >???xsd:schema??????????`http://www.w3.org/2001/XMLSchema`??`schema`
- ???????????????????DOM????????????????????????????DocumentBuilderFactory??setNamespaceAware()???
    ```
    factory.serNamespaceAware(true);
    ```
----
